<!DOCTYPE html>
<!--[if IE 7 ]><html class="ie ie7 lte9 lte8 lte7" lang="en-US"><![endif]-->
<!--[if IE 8]><html class="ie ie8 lte9 lte8" lang="en-US">	<![endif]-->
<!--[if IE 9]><html class="ie ie9 lte9" lang="en-US"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html class="noIE" lang="en-US"><!--<![endif]-->

<head>
	<meta charset="UTF-8" />
	<title>GFashion - Responsive e-commerce HTML Template</title>
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Favorite Icons -->
	<link rel="icon" href="../../img/common/favicon/favicon.html" type="image/x-icon" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144"
		href="../../img/common/favicon/apple-touch-icon-144x144-precomposed.html">
	<link rel="apple-touch-icon-precomposed" sizes="72x72"
		href="../../img/common/favicon/apple-touch-icon-72x72-precomposed.html">
	<link rel="apple-touch-icon-precomposed" href="../../img/common/favicon/apple-touch-icon-precomposed.html">
	<!-- // Favorite Icons -->

	<!--<link href='http://fonts.useso.com/css?family=Open+Sans:300,400,600,700' rel='stylesheet' type='text/css'>-->

	<!-- GENERAL CSS FILES -->
	<link rel="stylesheet" href="../../css/common/minified.css">
	<!-- // GENERAL CSS FILES -->

	<!--[if IE 8]>
		<script src="js/respond.min.js"></script>
		<script src="js/selectivizr-min.js"></script>
	<![endif]-->
	<!--
	<script src="js/jquery.min.js"></script>
	-->
	<script>window.jQuery || document.write('<script src="../../js/common/jquery.min.js"><\/script>');</script>
	<script src="../../js/common/modernizr.min.js"></script>
	<!-- PARTICULAR PAGES CSS FILES -->
	<link rel="stylesheet" href="../../css/common/innerpage.css">
	<link rel="stylesheet" href="../../css/common/owl.carousel.css">
	<link rel="stylesheet" href="../../css/common/owl.theme.css">
	<!-- // PARTICULAR PAGES CSS FILES -->
	<link rel="stylesheet" href="../../css/common/responsive.css">
	<style>
		/* -------------------登入功能css開始------------------- */
		body {
			background-color: white;
		}

		#username,
		#password,
		h3,
		#fullname,
		#comfirm_password,
		#username2,
		#password2,
		#acct,
		#email,
		#confirmedAcct,
		#confirmedEmail,
		#authCode,
		#newPw,
		#newPwAgain {
			width: 250px;
			height: 40px;
			margin: 10px;
			color: #df5334;
		}

		h5 {
			margin: 20px;
			color: #a3a2a3;
		}

		h5:hover {
			color: black;
		}

		#container1,
		#container2 {
			/* margin: 50px; */
			padding: 10px;
			/* width: 230px; */
			width: 500px;
			height: 550px;
			background-color: white;
			border-radius: 5px;
			border-top: 10px solid #df5334;
			box-shadow: 0 0px 70px rgba(0, 0, 0, 0.1);

			/*定位對齊*/
			position: relative;
			margin: auto;
			top: 100px;
			/* text-align:center;   */
		}

		.system_name {
			/*定位對齊*/
			position: relative;
			margin: auto;
			top: 100px;
			text-align: center;
		}

		.submit {
			color: white;
			background: #df5334;
			width: 200px;
			height: 30px;
			margin: 10px;
			padding: 5px;
			border-radius: 5px;
			border: 0px;
		}

		.submit:hover {
			background: #db6937;
		}

		#container2 {
			visibility: hidden;
			/*剛開始消失*/
			height: 350px;
		}


		#copyright {
			text-align: center;
			color: #a3a2a3;
			margin: -200px 0px 0px 0px;
			font-size: 14px;
		}

		input {
			padding: 5px;
			border: none;
			border: solid 1px #ccc;
			border-radius: 5px;
		}

		/* -------------------登入功能css結束------------------- */
		div.logo-wrapper {
			position: relative;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}
	</style>
</head>

<body>

	<!-- PAGE WRAPPER -->
	<div id="page-wrapper">

		<!-- SITE HEADER -->
		<header id="site-header" role="banner">
			<!-- HEADER TOP -->
			<div class="header-top">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-7">
							<!-- CONTACT INFO -->
							<div class="contact-info">
								<i class="iconfont-headphones round-icon"></i>
								<strong>+444 (100) 1234</strong>
								<span>(Mon- Fri: 09.00 - 21.00)</span>
							</div>
							<!-- // CONTACT INFO -->
						</div>
						<div class="col-xs-12 col-sm-6 col-md-5">
							<ul class="actions unstyled clearfix">
								<li>
									<!-- SEARCH BOX -->
									<div class="search-box">
										<form action="#" method="post">
											<div class="input-iconed prepend">
												<button class="input-icon"><i class="iconfont-search"></i></button>
												<label for="input-search" class="placeholder">Search here…</label>
												<input type="text" name="q" id="input-search"
													class="round-input full-width" required />
											</div>
										</form>
									</div>
									<!-- // SEARCH BOX -->
								</li>
								<li data-toggle="sub-header" data-target="#sub-social">
									<!-- SOCIAL ICONS -->
									<a href="javascript:void(0);" id="social-icons">
										<i class="iconfont-share round-icon"></i>
									</a>

									<div id="sub-social" class="sub-header">
										<ul class="social-list unstyled text-center">
											<li><a href="#"><i class="iconfont-facebook round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-twitter round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-google-plus round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-pinterest round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-rss round-icon"></i></a></li>
										</ul>
									</div>
									<!-- // SOCIAL ICONS -->
								</li>
								<li data-toggle="sub-header" data-target="#sub-cart">
									<!-- SHOPPING CART -->
									<a href="javascript:void(0);" id="total-cart">
										<i class="iconfont-shopping-cart round-icon"></i>
									</a>

									<div id="sub-cart" class="sub-header">
										<div class="cart-header">
											<span>Your cart is currently empty.</span>
											<small><a href="../../pages/member/cart.html">(See All)</a></small>
										</div>
										<ul class="cart-items product-medialist unstyled clearfix"></ul>
										<div class="cart-footer">
											<div class="cart-total clearfix">
												<span class="pull-left uppercase">Total</span>
												<span class="pull-right total">$ 0</span>
											</div>
											<div class="text-right">
												<a href="../../pages/member/cart.html"
													class="btn btn-default btn-round view-cart">View
													Cart</a>
											</div>
										</div>
									</div>
									<!-- // SHOPPING CART -->
								</li>
							</ul>
						</div>
					</div>
				</div>

				<!-- ADD TO CART MESSAGE -->
				<div class="cart-notification">
					<ul class="unstyled"></ul>
				</div>
				<!-- // ADD TO CART MESSAGE -->
			</div>
			<!-- // HEADER TOP -->
			<!-- MAIN HEADER -->
			<div class="main-header-wrapper">
				<div class="container">
					<div class="main-header">
						<!-- SITE LOGO -->
						<div class="logo-wrapper">
							<a href="../../index.html" class="logo"
								title="GFashion - Responsive e-commerce HTML Template">
								<img src="../../img/common/logo.png"
									alt="GFashion - Responsive e-commerce HTML Template" style="height: 120px" />
							</a>
						</div>
					</div>
				</div>
			</div>
			<!-- // MAIN HEADER -->
		</header>
		<!-- // SITE HEADER -->


		<!-- SITE MAIN CONTENT -->
		<main id="main-content" role="main">

			<div class="container">
				<!-- -------------------忘記密碼功能開始--------------------->
				<div class="forgetPassword_page" style="height: 520px;">
					<div id="container1" style="top: 20px; height: 450px">
						<div class="forgetPassword"
							style="display: flex;flex-direction: column;align-items: left;width: 80%;transform: translate(15%);">
							<!-- 撐版面用 -->
							<div style="margin-top:30px;"></div>
							<h3>忘記密碼</h3>
							<div id="inputArea">
								<div>
									<label for="帳號" style="width:60px">帳號：</label>
									<input type="text" id="acct" name="acct" placeholder="請輸入帳號：" required
										value="peter123" style="font-size: 16px;">
								</div>
								<div>
									<label for="email" style="width:60px">email：</label>
									<input type="text" id="email" name="email" placeholder="請輸入email" required
										value="peter123@gmail.com" style="font-size: 16px;">
								</div>
								<p id="checkMsg"
									style="visibility: hidden;color: red;font-size: 10px;margin-top: 30px;">
									帳號與email不匹配，請確認後再重新輸入</p>
								<button class="btn btn-primary btn-round padder loginSubmit"
									style="margin-top:20px; width: 50%; transform: translate(50%)"
									onclick="checkMemberAcct()">下一步</button>
							</div>
							<!-- </form> -->

						</div><!-- login end-->
					</div><!-- container1 end-->
				</div><!-- login_page end-->
			</div>
			<!-- -------------------忘記密碼功能結束--------------------->

		</main>
		<!-- // SITE MAIN CONTENT -->

		<!-- SITE FOOTER -->
		<footer class="page-footer">

			<!-- WIDGET AREA -->
			<div class="widgets">

				<!-- FIRST ROW -->
				<div class="section">
					<div class="container">
						<div class="row">

							<div class="col-xs-12 col-sm-6 col-md-3">
								<section class="widget widget-text">
									<h5 class="widget-title">our store</h5>
									<div class="widget-content">
										<p>Sed ornare cras donec litora integer curabitur orci, at nullam aliquam libero
											nam himenaeos, amet massa amet ut ipsum viverra mauris rhoncus neque aenean
											rhoncus gravida orci facilisis quis dui consectetur.</p>
										<p>Nisi porttitor inceptos consectetur donec orci, dui ipsum leo class gravida,
											felis primis viverra placerat.</p>
									</div>
								</section>
							</div>

							<div class="col-xs-12 col-sm-6 col-md-3">
								<section class="widget widget-text">
									<h5 class="widget-title">Opening Time</h5>
									<div class="widget-content">
										<p>Monday-Friday:-------------------------9.00 to 18.00</p>
										<p>Saturday:--------------------------------10.00 to 16.00</p>
										<p>Sunday:----------------------------------10.00 to 16.00</p>
										<br />
										<p>Every 30 day of month Lorem ipsum dolor sit amet, consectetur adipiscing.</p>
									</div>
								</section>
							</div>

							<div class="space40 visible-sm clearfix"></div>

							<div class="col-xs-12 col-sm-6 col-md-3">
								<section class="widget widget-menu">
									<h5 class="widget-title">information</h5>
									<div class="widget-content">
										<ul class="menu iconed-menu unstyled">
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Affiliate</a>
											</li>
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Shipping</a>
											</li>
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Shop
													support</a></li>
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Customer
													Service</a></li>
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Payment &
													Return</a></li>
											<li><a href="#"><i class="iconfont-circle-blank menu-icon"></i>Terms &
													Conditions</a></li>
										</ul>
									</div>
								</section>
							</div>

							<div class="col-xs-12 col-sm-6 col-md-3">
								facebook
							</div>

						</div>
					</div>
				</div>
				<!-- // FIRST ROW -->

				<!-- SECOND ROW -->
				<div class="section">
					<div class="container">
						<div class="row">

							<div class="col-xs-12 col-sm-12 col-md-3">
								<section class="widget widget-menu">
									<h5 class="widget-title">Contact info</h5>
									<div class="widget-content">
										<ul class="menu iconed-list unstyled">
											<li>
												<span class="list-icon"><i
														class="round-icon iconfont-map-marker"></i></span>
												<div class="list-content">Lorem ipsum maecenas dapibus luctus euismod
													133/2 New York City</div>
											</li>
											<li>
												<span class="list-icon"><i class="round-icon iconfont-phone"></i></span>
												<div class="list-content">(+00)1344356-675</div>
											</li>
											<li>
												<span class="list-icon"><i
														class="round-icon iconfont-envelope-alt"></i></span>
												<div class="list-content">support@themina.net</div>
											</li>
										</ul>
									</div>
								</section>
							</div>

							<div class="col-xs-12 col-sm-12 col-md-6">
								<section class="widget widget-ads">
									<div class="widget-content">
										<div class="center-xs">
											<div class="ads">
												<a href="#">
													<img src="../../img/common/demo/images-footer.jpg" alt="" />
												</a>
												<div class="ads-caption bottom-right">
													<a href="#" class="btn btn-default btn-round">
														<i class="round-icon iconfont-angle-right"></i>
														<span class="inline-middle">Show More</span>
													</a>
												</div>
											</div>
										</div>
									</div>
								</section>
							</div>

							<div class="col-xs-12 col-sm-12 col-md-3">
								<section class="widget widget-subscription">
									<h5 class="widget-title">Newletter</h5>
									<div class="widget-content">
										<p>Subscribe to be the first to know about Sales, Events, and Exclusive Offers!
										</p>
										<form action="#" method="post">
											<div class="input-group">
												<label for="subscription-email" class="placeholder">Enter Your
													Email</label>
												<input type="email" id="subscription-email" name="email"
													class="form-control" required />
												<span class="input-group-btn">
													<button class="btn btn-primary">Subscribe</button>
												</span>
											</div>
										</form>
									</div>
								</section>
							</div>

						</div>
					</div>
				</div>
				<!-- // SECOND ROW -->

			</div>
			<!-- // WIDGET AREA -->

			<div class="footer-sub">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-6">
							<div class="footer-links center-xs clearfix">
								<ul class="unstyled">
									<li><a href="#">Site Map</a></li>
									<li><a href="#">FAQ</a></li>
									<li><a href="#">Work for us</a></li>
									<li><a href="#">Contact Us</a></li>
								</ul>
							</div>
							<div class="space10"></div>
							<div class="copyright center-xs">
								<p>(c) 2013 More Templates <a href="http://www.cssmoban.com/" target="_blank"
										title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/"
										title="网页模板" target="_blank">网页模板</a>. All Rights Reserved.</p>
							</div>
						</div>

						<div class="space40 visible-xs"></div>

						<div class="col-xs-12 col-sm-6 center-xs">
							<div class="pull-right">
								<div class="vmid">
									<span class="uppercase">Payment Accept&emsp;</span>
									<a href="#"><img src="../../img/common/visacard.png" alt="" width="40" /></a>
									<a href="#"><img src="../../img/common/mastercard.png" alt="" width="40" /></a>
									<a href="#"><img src="../../img/common/paypal.png" alt="" width="40" /></a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</footer>
		<!-- // SITE FOOTER -->

	</div>
	<!-- // PAGE WRAPPER -->

	<!-- Essential Javascripts -->
	<script src="../../js/common/minified.js"></script>
	<!-- // Essential Javascripts -->

	<!-- Particular Page Javascripts -->
	<script src="../../js/common/products.js"></script>
	<script src="../../js/common/owl.carousel.js"></script>
	<script src="../../js/common/contact.js"></script>
	<!--<script src="http://maps.googleapis.com/maps/api/js?sensor=false" type="text/javascript"></script>-->
	<!-- <script src="../../js/common/gmap3.min.js"></script> -->
	<!-- // Particular Page Javascripts -->

	<!-- vscode -->
	<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
	<!-- tomcat -->
	<!-- <script src="../js/jquery.min.js"></script>  -->
	<script>
		function checkMemberAcct() {
			fetch('/BuyGo/api/front_end/checkMemberEmail', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					memberAcct: $("div#inputArea").find("input#acct").val(), // 將輸入的會員帳號傳送至後端
					memberEmail: $("div#inputArea").find("input#email").val() // 將輸入的信箱傳送至後端
				})
			})
				.then(resp => resp.json())
				.then(body => {
					const { successful, memberAcct, memberEmail } = body;
					if (successful) { // 如果後端有成功搜尋到該會員帳號在資料庫中
						sendResetPwMail(memberAcct, memberEmail); // 發送mail
						$("div#inputArea").html(""); // 清空所有輸入框與按鈕

						$("div#inputArea").append(`
							<div>
								<label for="confirmedAcct" style="width:60px">帳號：</label>
								<input type="text" id="confirmedAcct" name="confirmedAcct" value="${memberAcct}" style="font-size: 16px;" disabled="disabled">
							</div>
							<div>
								<label for="confirmedEmail" style="width:60px">email：</label>
								<input type="text" id="confirmedEmail" name="confirmedEmail" value="${memberEmail}" style="font-size: 16px;" disabled="disabled">
							</div>
							<div>
								<label for="authCode" style="width:60px">驗證碼：</label>
								<input type="text" id="authCode" name="authCode" style="font-size: 16px;color: black" required>
							</div>
							<p id="checkMsg"
									style="visibility: hidden;color: red;font-size: 10px;margin-top: 30px;">
									驗證碼不正確</p>
							<button class="btn btn-primary btn-round padder loginSubmit"
									style="margin-top:20px; width: 50%; transform: translate(50%)"
									onclick="checkResetPwAuthCode('${memberAcct}')">下一步</button>
						`);
					}
					else { // 如果後端沒搜尋到該會員帳號在資料庫中
						$("div#inputArea").find('p#checkMsg').css('visibility', 'visible'); // 將失敗訊息顯示出來
					}
				});
		}
		function sendResetPwMail(memberAcct, memberEmail) {
			fetch('/BuyGo/api/front_end/sendResetPwMail', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					memberAcct: memberAcct,
					memberEmail: memberEmail
				})
			})
		}
		function checkResetPwAuthCode(memberAcct) {
			fetch('/BuyGo/api/front_end/checkResetPwAuthCode', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					authCode: $("div#inputArea").find("input#authCode").val() // 將輸入的authCode傳送至後端
				})
			})
				.then(resp => resp.json())
				.then(body => {
					const { successful } = body;
					if (successful) { // 驗證成功
						// console.log("驗證成功");
						$("div#inputArea").html(""); // 清空所有輸入框與按鈕

						$("div#inputArea").append(`
							<div>
								<label for="newPw" style="width:100px">新密碼：</label>
								<input type="password" id="newPw" name="newPw" style="font-size: 16px;">
							</div>
							<div>
								<label for="newPwAgain" style="width:100px">再次輸入密碼：</label>
								<input type="password" id="newPwAgain" name="newPwAgain" style="font-size: 16px;">
							</div>
							<p id="checkMsg"
									style="visibility: hidden;color: red;font-size: 10px;margin-top: 30px;">
									新密碼與再次輸入密碼不匹配，請重新輸入</p>
							<button class="btn btn-primary btn-round padder loginSubmit"
									style="margin-top:20px; width: 50%; transform: translate(50%)"
									onclick="resetPw()">送出</button>
						`);
					}
					else { // 驗證失敗
						// console.log("驗證失敗");
						$("div#inputArea").find('p#checkMsg').css('visibility', 'visible'); // 將失敗訊息顯示出來
					}
				})
		};
		function resetPw() {
			const newPassword = $("div#inputArea").find("input#newPw").val();
			const newPasswordAgain = $("div#inputArea").find("input#newPwAgain").val();
			if (newPassword === newPasswordAgain) {
				fetch('/BuyGo/api/front_end/resetPw', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json;charset:utf-8' },
					body: JSON.stringify({
						memberPw: $("div#inputArea").find("input#newPw").val()
					})
				})
				.then(resp => resp.json())
				.then(body => {
					const { successful } = body;
					if(successful){
						$("div#inputArea").html(""); // 清空所有輸入框與按鈕

						$("div#inputArea").append(`
							<div>
								<h4>密碼修改成功，請關閉此頁面重新登入</h4>
							</div>
						`);
					}
					else{
						$("div#inputArea").find('p#checkMsg').text("修改異常，請聯絡管理員")
						$("div#inputArea").find('p#checkMsg').css('visibility', 'visible'); // 將失敗訊息顯示出來
					}
				})
			}
			else{
				$("div#inputArea").find('p#checkMsg').css('visibility', 'visible'); // 將失敗訊息顯示出來
			}

		}

	</script>
</body>

</html>