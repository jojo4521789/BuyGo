<!DOCTYPE html>
<!--[if IE 7 ]><html class="ie ie7 lte9 lte8 lte7" lang="en-US"><![endif]-->
<!--[if IE 8]><html class="ie ie8 lte9 lte8" lang="en-US">	<![endif]-->
<!--[if IE 9]><html class="ie ie9 lte9" lang="en-US"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html class="noIE" lang="en-US">
<!--<![endif]-->

<head>
	<meta charset="UTF-8" />
	<title>BuyGo - 揪團賣場 - 商品詳情</title>
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Favorite Icons -->
	<link rel="icon" href="../../../img/common/favicon/favicon.html" type="image/x-icon" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144"
		href="../../../img/common/favicon/apple-touch-icon-144x144-precomposed.html">
	<link rel="apple-touch-icon-precomposed" sizes="72x72"
		href="../../../img/common/favicon/apple-touch-icon-72x72-precomposed.html">
	<link rel="apple-touch-icon-precomposed" href="../../../img/common/favicon/apple-touch-icon-precomposed.html">
	<!-- // Favorite Icons -->

	<!--<link href='http://fonts.useso.com/css?family=Open+Sans:300,400,600,700' rel='stylesheet' type='text/css'>-->

	<!-- GENERAL CSS FILES -->
	<link rel="stylesheet" href="../../../css/common/minified.css">
	<!-- // GENERAL CSS FILES -->

	<!--[if IE 8]>
		<script src="js/respond.min.js"></script>
		<script src="js/selectivizr-min.js"></script>
	<![endif]-->
	<!--
	<script src="js/jquery.min.js"></script>
	-->
	<script>window.jQuery || document.write('<script src="../../../js/common/jquery.min.js"><\/script>');</script>
	<script src="../../../js/common/modernizr.min.js"></script>
	<!-- PARTICULAR PAGES CSS FILES -->
	<link rel="stylesheet" href="../../../css/common/jquery.nouislider.css">
	<link rel="stylesheet" href="../../../css/common/owl.carousel.css">
	<link rel="stylesheet" href="../../../css/common/owl.theme.css">
	<link rel="stylesheet" href="../../../css/common/innerpage.css">
	<!-- // PARTICULAR PAGES CSS FILES -->
	<link rel="stylesheet" href="../../../css/common/responsive.css">

	<style>
		.logo img {
			max-width: 200px;
			max-height: 150px;
		}

		.user-menu a img {
			max-width: 20px;
			max-height: 20px;
		}

		ul.user_menu>ul>a {
			color: #ef7700;
			font-weight: bold;
			font-size: 25px;
		}

		a:hover {
			color: #0150ed;
		}

		.product {
			width: 273px;
			display: inline-block;
			margin-right: 7px;
			margin-left: 7px
		}

		#thumbnails {
			overflow: auto;
			max-height: auto;
		}

		/* Image Slider CSS Start */

		body {
			background: #e6e6e6;
		}

		#slider {
			width: 80%;
			margin: 0 auto;
			position: relative;
			overflow: hidden;
			box-shadow: 2px 5px 10px rgba(0, 0, 0, 0.4);
			;
		}

		.slide {
			width: 100%;

			/* display: none; */
			animation-name: fade;
			animation-duration: 1s;

		}

		img {
			width: 100%;
		}

		@keyframes fade {
			from {
				opacity: 0.5;
			}

			to {
				opacity: 1;
			}
		}

		.controls {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			font-size: 1.5em;
			padding: 15px 10px;
			border-radius: 5px;

		}

		.controls:hover {
			background: white;
			transition: 0.3s;
		}

		.controls:active {
			color: grey;
		}

		#left-arrow {
			left: 10px;
		}

		#right-arrow {
			right: 10px;
		}

		#dots-con {

			text-align: center;
		}

		.dot {
			display: inline-block;
			background: grey;
			padding: 8px;
			border-radius: 50%;
			margin: 10px 5px;
		}

		.active_dot {
			background: crimson;
		}

		@media (max-width:576px) {
			#slider {
				width: 100%;

			}

			.controls {
				font-size: 1em;
			}

			#dots-con {
				display: none;
			}
		}

		/* Image Slider CSS End */
		/*-----------------燈箱css開始-----------------*/
		#lightbox,
		#orderNowLightbox {
			/*   border: 1px solid red; */
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100vh;
			background-color: hsla(0, 0%, 0%, .5);
		}

		.none {
			display: none;
		}

		/* 元素 article 置中及基本樣式 */
		#lightbox>article,
		#orderNowLightbox>article {
			background-color: white;
			width: 90%;
			max-width: 350px;
			border-radius: 10px;
			box-shadow: 0 0 10px #ddd;
			padding: 10px;
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
		}

		/*-----------------燈箱css結束-----------------*/
	</style>
</head>

<body class="product-single">

	<!-- PAGE WRAPPER -->
	<div id="page-wrapper">

		<!-- SITE HEADER -->
		<header id="site-header" role="banner">
			<!-- HEADER TOP -->
			<div class="header-top">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-7">
							<!-- CONTACT INFO -->
							<div class="contact-info">
								<i class="iconfont-headphones round-icon"></i>
								<strong>(03)425-1108</strong>
								<span>(Mon- Fri: 09.00 - 21.00)</span>
							</div>
							<!-- // CONTACT INFO -->
						</div>
						<div class="col-xs-12 col-sm-6 col-md-5">
							<ul class="actions unstyled clearfix">
								<li>
									<!-- SEARCH BOX -->
									<div class="search-box">
										<form action="#" method="post">
											<div class="input-iconed prepend">
												<button class="input-icon">
													<i class="iconfont-search"></i>
												</button>
												<label for="input-search" class="placeholder">Search
													here…</label> <input type="text" name="q" id="input-search"
													class="round-input full-width" required />
											</div>
										</form>
									</div>
									<!-- // SEARCH BOX -->
								</li>
								<li data-toggle="sub-header" data-target="#sub-social">
									<!-- SOCIAL ICONS --> <a href="javascript:void(0);" id="social-icons"> <i
											class="iconfont-share round-icon"></i>
									</a>

									<div id="sub-social" class="sub-header">
										<ul class="social-list unstyled text-center">
											<li><a href="#"><i class="iconfont-facebook round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-twitter round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-google-plus round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-pinterest round-icon"></i></a></li>
											<li><a href="#"><i class="iconfont-rss round-icon"></i></a></li>
										</ul>
									</div> <!-- // SOCIAL ICONS -->
								</li>
								<li data-toggle="sub-header" data-target="#sub-cart">
									<!-- SHOPPING CART -->
									<a href="javascript:void(0);" id="total-cart">
										<i class="iconfont-shopping-cart round-icon"></i>
									</a>
	
									<div id="sub-cart" class="sub-header">
										<div class="cart-header">
											<span>Your cart is currently empty.</span>
											<small><a href="/BuyGo/front_end/pages/member/opa/cart/cart.html">(See All)</a></small>
										</div>
										<!-- <ul class="cart-items product-medialist unstyled clearfix"></ul> -->
										<ul class="s-cart-items product-medialist unstyled clearfix"></ul>
										<div class="cart-footer">
											<!-- <div class="cart-total clearfix">
												<span class="pull-left uppercase">Total</span>
												<span class="pull-right total">$ 0</span>
											</div> -->
											<div class="s-cart-total clearfix">
												<span class="pull-left uppercase">Total</span>
												<span class="pull-right total">$ 0</span>
											</div>
											<div class="text-right">
												<a href="/BuyGo/front_end/pages/member/opa/cart/cart.html"
													class="btn btn-default btn-round view-cart">查看購物車</a>
											</div>
										</div>
									</div>
									<!-- // SHOPPING CART -->
								</li>
							</ul>
						</div>
					</div>
				</div>

				<!-- ADD TO CART MESSAGE -->
				<!-- <div class="cart-notification">
					<ul class="unstyled"></ul>
				</div> -->
				<!-- // ADD TO CART MESSAGE -->
			</div>
			<!-- // HEADER TOP -->
			<!-- MAIN HEADER -->
			<div class="main-header-wrapper">
				<div class="container">
					<div class="main-header">
						<!-- CURRENCY / LANGUAGE / USER MENU -->
						<div class="actions">
							<div class="center-xs">

							</div>
							<div class="clearfix"></div><br>
							<!-- USER RELATED MENU -->
							<nav id="tiny-menu" class="clearfix">
								<ul class="user-menu">
									<li><a href="../../../member/myaccount.html" class="personal">我的帳戶<img
												src="../../../../img/common/head.png"></a>
									</li>
									<!-- <li><a href="pages/member/opa/cart/cart.html" class="paymoney">結帳<img
						src="../front_end/img/common/paymoney.png"></a></li> -->
									<li id="logInAndLogOut"><a href="../../../member/login.html" class="loginOut">登入<img
												src="../../../../img/common/login.png"></a>
									</li>
								</ul><br>
							</nav>
							<!-- // USER RELATED MENU -->
						</div>
						<!-- // CURRENCY / LANGUAGE / USER MENU -->
						<!-- SITE LOGO -->
						<div class="logo-wrapper">
							<a href="/BuyGo/front_end/index.html" class="logo">
								<img src="/BuyGo/front_end/img/common/buygo.png" />
							</a>
						</div>
						<!-- // SITE LOGO -->
						<!-- SITE NAVIGATION MENU -->
						<nav id="site-menu" role="navigation">
							<ul class="main-menu hidden-sm hidden-xs">
								<li>
									<a href="/BuyGo/front_end/index.html">首頁</a>
								</li>
								<li>
									<a href="/BuyGo/front_end/pages/guest/pa/prods/prods.html">一般賣場</a>
								</li>
								<li>
									<a href="/BuyGo/front_end/pages/guest/opa/prods/prods.html">官方賣場</a>
								</li>
								<li class="active">
									<a href="/BuyGo/front_end/pages/guest/gpa/prods/prods.html">揪團賣場</a>
								</li>
								<li>
									<a href="/BuyGo/front_end/pages/Articles.html">論壇</a>
								</li>
							</ul>

							<!-- MOBILE MENU -->
							<div id="mobile-menu" class="dl-menuwrapper visible-xs visible-sm">
								<button class="dl-trigger"><i class="iconfont-reorder round-icon"></i></button>

							</div>
							<!-- // MOBILE MENU -->

						</nav>
						<!-- // SITE NAVIGATION MENU -->
					</div>
				</div>
			</div>
			<!-- // MAIN HEADER -->
		</header>
		<!-- // SITE HEADER -->

		<!-- BREADCRUMB -->
		<div class="breadcrumb-container">
			<div class="container">
				<div class="relative">
					<ul class="bc unstyled clearfix">
						<li><a href="/BuyGo/front_end/index.html">首頁</a></li>
						<li><a href="/BuyGo/front_end/pages/guest/gpa/prods/prods.html">揪團賣場</a></li>
						<li class="active">商品詳情</li>
					</ul>
				</div>
			</div>
		</div>
		<!-- // BREADCRUMB -->

		<!-- SITE MAIN CONTENT -->
		<main id="main-content" role="main">

			<section class="section">
				<!-- <section class="section" id="section-big" style=" padding: 50px 220px;"> -->
				<div class="container">
					<div class="row">
						<!-- PRODUCT PREVIEW -->

						<div class="col-xs-12 col-sm-4">

							<div class="product-preview">
								<!-- <a id="prodPicPrevious" class="round-icon" onclick="changeProdPic(-1)" href="#"
									data-toggle="tooltip" data-original-title="" title=""
									style="position:absolute; z-index:9999; left: 5px; top: 180px"><i
										class="iconfont-angle-left"></i></a> -->
								<!-- <a id="prodPicNext" class="round-icon" onclick="changeProdPic(1)" href="#"
									data-toggle="tooltip" data-original-title="" title=""
									style="position:absolute; z-index:9999; right: 5px; top: 180px"><i
										class="iconfont-angle-right"></i></a> -->
								<div style=" width: 360px; height:400px; position: relative;">

									<!--Controlling arrows (按鈕)-->
									<span class="controls" onclick="prevSlide(-1)" id="left-arrow"
										style="position:absolute; z-index:9999; left: 5px; top: 200px">
										<i class="iconfont-angle-left" aria-hidden="true"></i>
									</span>
									<span class="controls" id="right-arrow" onclick="nextSlide(1)"
										style="position:absolute; z-index:9999; right: 5px; top: 200px">
										<i class="iconfont-angle-right" aria-hidden="true"></i>
									</span>


									<div id="slider" style=" width: 100%; height:100%;">
									</div>


								</div>

								<div id="dots-con">
									<!-- <span class="dot"></span> -->
								</div>

							</div>

						</div>
						<!-- // PRODUCT PREVIEW -->
						<div class="space40 visible-xs"></div>

						<!-- PRODUCT DETAILS -->

						<!-- <div class="col-xs-12 col-sm-8"> -->
						<div class="col-xs-12 col-sm-8">
							<!-- <div> -->
							<section class="product-details add-cart">
								<header class="entry-header">
									<h2 class="entry-title uppercase" id="prodName"></h2>
								</header>
								<article class="entry-content">
									<figure>
										<span class="entry-price inline-middle" id="afterProdPrice"
											style="margin-right: 10px;"></span>
										<span class="entry-price inline-middle" id="beforeProdPrice"
											style="display: none; margin-right: 10px; font-size: 18px;"></span>
										<button id="gpaReach" type="button" class="btn btn-info btn-xs btn-round"
											style="font-size: 4px;">商品達標門檻</button>

										<ul class="entry-meta unstyled">
											<li>
												<span class="key">賣家:</span> <span class="value" id="memberAcct"></span>
												<br>
												<button id="addChatroom" type="button"
													class="btn btn-warning btn-xs btn-round"
													style="font-size: 4px;">加入聊天室</button>
												<button id="addBlacklist" type="button"
													class="btn btn-danger btn-xs btn-round"
													style="font-size: 4px;">加入黑名單</button>
											</li>
											<li><span class="key">商品編號:</span> <span class="value"
													id="gpaProdNo"></span>
											</li>
											<li><span class="key">商品類別:</span> <span class="value"
													id="gpaCatsNo"></span>
											</li>
											<li><span class="key">已預定數量:</span> <span class="value"
													id="gpaPreProd"></span>
											</li>
											<li><span class="key">最低成團數量:</span> <span class="value"
													id="gpaMiniCount"></span>
											</li>
											<li><span class="key">庫存數量:</span> <span class="value" id="stockQty"></span>
											</li>
											<li><span class="key">商品說明:</span> <span class="value" id="prodText"></span>
											</li>
											<li><span class="key">截止日期:</span> <span class="value"
													id="gpaEndDate"></span>
											</li>
										</ul>

										<ul class="inline-li li-m-r-l m-t-lg">
											<li><button id="Rp_btn" class="btn btn-default btn-lg btn-round add-to-cart"
													style="background: #be3232">檢舉商品</button>
											</li>
											<li><a id="track" href="#"
													class="btn btn-warning btn-lg btn-round add-to-cart">加入追蹤</a>
											</li>
											<li><a id="orderNow" href="#" class="btn btn-default btn-lg btn-round"
													onclick="showOrderNow()">立即預定</a>
											</li>
										</ul>

										<!-- 測試開始 -->
										<!-- <a class="round-icon" href="#" data-toggle="tooltip" data-title="Next Picture" data-original-title="" title=""><i class="iconfont-angle-right"></i></a>
										<a class="round-icon" href="#" data-toggle="tooltip" data-title="Previous Picture" data-original-title="" title=""><i class="iconfont-angle-left"></i></a> -->
										<!-- 測試結束 -->

									</figure>
								</article>
								<!-- 燈箱開始 -->
								<!-- <div id="lightbox" class="none" style="z-index:9999;">
									<article id="lightboxContentArea">
										<div id="gpaReachList"></div>
										<button id="lightbox_close">關閉</button>
									</article>
								</div> -->
								<!-- 燈箱結束 -->
								<!-- 燈箱表單 -->
								<div id="lightbox" class="none" style="z-index:9999;">
									<article id="lightboxContentArea">
										<button id="lightbox_close" class="close-button">關閉</button>

										<select id="selectSausage">
											<option value="1">一般商場</option>
											<option value="2">揪團賣場</option>
										</select><br>
										<span>商品編號:</span><input type="text" id="prodNo"><br>
										<span>賣家編號:</span><input type="text" id="sellerNo"><br>
										<select id="reportReason">
											<option value="0">0: 藥品, 醫療器材</option>
											<option value="1">1: 酒類 / 菸類商品</option>
											<option value="2">2: 武器 / 彈藥 / 軍事用品</option>
											<option value="3">3: 活體動物, 保育動物及其製品</option>
											<option value="4">4: 導向外部資訊或交易</option>
											<option value="5">5: 此商品可能令人感到不適或違反善良風俗</option>
											<option value="6">6: 仿冒品</option>
											<option value="7">7: 重覆刊登/複製他人商品圖文</option>
											<option value="8">8: 違反鑑賞期</option>
											<option value="9">9: 疫區/國外肉製, 蛋, 海鮮, 寵物食品</option>
											<option value="10">10: 刷單製造不實銷量</option>
											<option value="11">11: 濫用文字誤導搜尋</option>
											<option value="12">12: NCC/BSMI認證字號未填寫</option>
											<option value="13">13: 誇大不實療效/涉及醫療效能</option>
											<option value="14">14:其他</option>
										</select>
										<label for="reportContent">檢舉理由：</label>
										<textarea id="reportContent" name="reportContent" required></textarea>
										<button type="button" id="submit_report">提交檢舉</button>

									</article>
								</div>
								<!-- 燈箱結束-->
							</section>
						</div>
						<!-- // PRODUCT DETAILS -->
					</div>
				</div>
			</section>

			<!-- FEATURED PRODUCTS -->
			<div style="height: auto;">

				<hr style="width: calc(100% - 200px); height: 1px; font-weight: bold; background-color: white;">
				<h3 class="section-title" style="text-align: center; margin: 0;">推薦商品</h3>
				<p style="text-align: center; color: gray;">為您推薦同類型中您可能有興趣的商品</p>

				<div id="ranRecommend" style="margin-left: 45px; overflow: auto;">

				</div>



			</div>
			<!-- // FEATURED PRODUCTS -->

		</main>
		<!-- // SITE MAIN CONTENT -->

		<!-- SITE FOOTER -->
		<footer class="page-footer">

			<!-- WIDGET AREA -->
			<div class="widgets">

				<!-- FIRST ROW -->

				<!-- // FIRST ROW -->

				<!-- SECOND ROW -->
				<div class="section">
					<div class="container">
						<div class="row">

							<div class="col-xs-12 col-sm-12 col-md-5">
								<section class="widget widget-menu">
									<h5 class="widget-title">Contact info</h5>
									<div class="widget-content">
										<ul class="menu iconed-list unstyled">
											<li><span class="list-icon"><i
														class="round-icon iconfont-map-marker"></i></span>
												<div class="list-content">中壢區復興路 46 號緯育 TibaMe 附設中壢職訓中心 9 樓</div>
											</li>
											<li><span class="list-icon"><i class="round-icon iconfont-phone"></i></span>
												<div class="list-content">(03) 425-1108</div>
											</li>
											<li><span class="list-icon"><i
														class="round-icon iconfont-envelope-alt"></i></span>
												<div class="list-content">tibamecha102g6@gmail.com</div>
											</li>
										</ul>
									</div>
								</section>
							</div>

							<div class="col-xs-12 col-sm-12 col-md-6">
								<section class="widget widget-ads">
									<div class="widget-content">
										<div class="center-xs">
											<div class="ads">
												<a href="#"> <img src="/BuyGo/front_end/img/common/demo/images-footer.jpg"
														alt="" />
												</a>
											</div>
										</div>
									</div>
								</section>
							</div>
						</div>
					</div>
				</div>
				<!-- // SECOND ROW -->

			</div>
			<!-- // WIDGET AREA -->

			<div class="footer-sub">
				<div class="container">
					<div class="row">
						<div class="col-xs-12 col-sm-6">
							<div class="footer-links center-xs clearfix">
								<ul class="unstyled">
									<li><a href="/BuyGo/front_end/pages/guest/selectFirstFAQ.html">FAQ</a></li>
								</ul>
							</div>
							<div class="space10"></div>
							<div class="copyright center-xs">
								<p>(c) 2023</p>
							</div>
						</div>

						<div class="space40 visible-xs"></div>


					</div>
				</div>
			</div>

		</footer>
		<!-- // SITE FOOTER -->

	</div>
	<!-- // PAGE WRAPPER -->
	<!-- 達標燈箱開始 -->
	<div id="lightbox" class="none" style="z-index:9999;">
		<article id="lightboxContentArea">
			<div id="gpaReachList"></div>
			<button id="lightbox_close">關閉</button>
		</article>
	</div>
	<!-- 達標燈箱結束 -->
	<!-- 預定燈箱開始 -->
	<div id="orderNowLightbox" class="none" style="z-index:9999;">
		<article id="orderNowLightboxContentArea">
			<h3>運送資訊</h3>
			<div style="margin: 10px 0px;">
				<label for="shippingSelect" style="width: 100px" class="required">運送方式：</label>
				<select id="shippingSelect" class="form-control" style="width: 150px; display: inline-block;">
					<option>黑貓宅急便</option>
				</select>
			</div>
			<div style="margin: 10px 0px;">
				<label for="gpaBuyName" style="width: 100px" class="required">收貨人：</label>
				<!-- <input id="gpaBuyName" type="text"> -->
				<input type="text" class="form-control" id="gpaBuyName" style="width: 100px; display: inline-block;">
				<span id="gpaBuyNameCheck" style="color: red; visibility: hidden;">此欄位必須輸入</span>
			</div>
			<div style="margin: 10px 0px;">
				<label for="gpaBuyTel" style="width: 100px" class="required">收貨人電話：</label>
				<input type="text" class="form-control" id="gpaBuyTel" style="width: 100px; display: inline-block;">
				<span id="gpaBuyTelCheck" style="color: red; visibility: hidden;">此欄位必須輸入</span>
			</div>
			<div style="margin: 10px 0px;">
				<label for="gpaBuyAdd" style="width: 100px" class="required">收貨人地址：</label>
				<input type="text" class="form-control" id="gpaBuyAdd" style="width: 100px; display: inline-block;">
				<span id="gpaBuyAddCheck" style="color: red; visibility: hidden;">此欄位必須輸入</span>
			</div>
			<div>
				<h5>運費：<span>100</span></h5>
				<h4 style="color: red;">總金額：<span id="orderNowLightbox_totoalPrice"></span></h4>
			</div>

			<h3>付款方式</h3>

			<div>
				<input type="radio" id="contactChoice1" name="paymentMethodRadio" checked
					onclick="$('button#orderNowLightbox_walletconfirm').css('display', 'none'); $('button#orderNowLightbox_confirm').css('display', '');" />
				<label for="contactChoice1">線上刷卡</label>
			</div>
			<div>
				<input type="radio" id="contactChoice2" name="paymentMethodRadio"
					onclick="$('button#orderNowLightbox_walletconfirm').css('display', ''); $('button#orderNowLightbox_confirm').css('display', 'none');" />
				<label for="contactChoice2">平台錢包</label>
			</div>

			<span id="gpaPreProdCheck" style="color: red; visibility: hidden;">該商品庫存量為0，不可預定</span>

			<br>

			<button id="orderNowLightbox_confirm" type="button" class="btn btn-success"
				onclick="orderNowByCreditCard()">進入結帳頁面</button>
			<button id="orderNowLightbox_walletconfirm" type="button" class="btn btn-success"
				onclick="orderNowByWallet()" style="display: none;">使用錢包支付</button>
			<button id="orderNowLightbox_close" type="button" class="btn btn-danger">關閉</button>
		</article>
	</div>
	<!-- 預定燈箱結束 -->

	<!-- Essential Javascripts -->
	<script src="../../../js/common/minified.js"></script>
	<!-- // Essential Javascripts -->

	<!-- Particular Page Javascripts -->
	<script src="../../../js/common/jquery.nouislider.js"></script>
	<script src="../../../js/common/owl.carousel.js"></script>
	<script src="../../../js/common/products.js"></script>
	<!-- // Particular Page Javascripts -->

	<!-- Disqus -->
	<script type="text/javascript">
		/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		var disqus_shortname = 'gfashion';		// required: replace example with your forum shortname

		/* * * DON'T EDIT BELOW THIS LINE * * */
		(function () {
			var dsq = document.createElement('script'); dsq.async = true;
			dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<!-- // Disqus -->

	<script src="../../../js/login.js"></script>

	<!-- 載入sweetalert -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- 導入Moment.js -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

	<script>
		const loginData = checkLoginStatusShowMemberAcct(); // 檢查客戶帳號是否登入，修改頁面右上方Log In/Log Out按鈕，顯示登入者帳號名稱

		let currentBuyerMemberNo = ""; // 全域變數，用以保存買家的memberNo
		let currentSelectOfPic = 0; // 全域變數，用以記錄當前商品的照片選擇
		let maxPicNumOfProd = 0; // 全域變數，用以記錄當前商品照片的最大數量
		let currentGpaProdNo = 0; // 全域變數，用以記錄當前頁面的GpaProdNo
		let currentGpaProdName = ""; // 全域變數，用以記錄當前頁面的商品名稱
		let currentGpaProdPrice = 0; // 全域變數，用以記錄當前頁面的商品價格

		loginData.then(function (memberDetail) { // 因取得memberNo為非同步(fetch後再收到伺服器返回值)，故須將有使用到memberDetail(矩陣[0]為memberNo, 矩陣[1]為memberAcct)的程式包在loginData內，確保程式是在memberNo收到值後才執行
			let memberNo = memberDetail[0];
			let memberAcct = memberDetail[1];

			currentBuyerMemberNo = memberNo;
		});

		window.addEventListener("load", function () {

			//---------------------------------------元素-------------------------------------------------------

			// const memberNo_el = document.querySelector("#memberNo");
			// const prodName_el = document.querySelector("#prodName");
			// const prodObj_el = document.querySelector("#prodObj");
			// const prodPrice_el = document.querySelector("#prodPrice");
			// const shipQty_el = document.querySelector("#shipQty");
			// const stockQty_el = document.querySelector("#stockQty");
			// const prodNo_el = document.querySelector("#prodNo");
			// const prodText_el = document.querySelector("#prodText");

			// const objName_el = document.querySelector("#objName");
			// const objPrice_el = document.querySelector("#objPrice");

			//             const ranRecommend_el = document.querySelector("#ranRecommend");

			let paProdPicNoArray = [];
			let count = 0;

			//---------------------------------------fetch-------------------------------------------------------
			const urlParams = new URLSearchParams(window.location.search); // 取得當前網址url GET的parameter(url網址?之後的部分)
			const currentParameterValue_gpaProdNo = urlParams.get('gpaProdNo'); // 將parameter gpaProdNo的值保存
			currentGpaProdNo = currentParameterValue_gpaProdNo; // 將gpaProdNo的值保存至全域變數
			// 依當前url的parameter數值，發送fetch的GET方法以從後端取得指定gpaProdNo的商品資訊，並渲染於頁面
			fetch(`/BuyGo/api/front_end/gpaProdlist?action=loadGpaProdlist&gpaProdNo=${currentParameterValue_gpaProdNo}`, {
				method: 'GET',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
			})
				.then(resp => resp.json())
				.then(body => {
					let { gpaProdNo, memberNo, memberAcct, gpaCatsNo, gpaProdName, gpaFirstPrice, gpaProdContent, gpaPreProd, gpaMiniCount, gpaMaxCount, gpaEndDate, gpaProdPics, gpaReach } = body;

					currentGpaProdName = gpaProdName; // 將gpaProdName的值保存至全域變數
					currentGpaProdPrice = gpaFirstPrice; // 將gpaFirstPrice的值保存至全域變數

					// 將gpaEndDate更換時間格式為指定格式
					let gpaEndDateToMoment = moment(gpaEndDate, "MMM DD, YYYY, h:mm:ss A");
					let gpaEndDateToformatted = gpaEndDateToMoment.format("YYYY-MM-DD HH:mm");

					$("h2#prodName").text(gpaProdName);
					$("span#afterProdPrice").text("$ " + gpaFirstPrice);
					$("span#prodText").text(gpaProdContent);
					$("span#gpaProdNo").text(gpaProdNo);
					$("span#memberAcct").text(memberAcct);
					$("span#gpaCatsNo").text(changeObjText(gpaCatsNo));
					$("span#gpaPreProd").text(gpaPreProd);
					$("span#gpaMiniCount").text(gpaMiniCount);
					$("span#stockQty").text(gpaMaxCount - gpaPreProd);
					$("span#gpaEndDate").text(gpaEndDateToformatted);

					// 將gpaEndDate轉為Date，以比較當前時間與gpaEndDate時間來得知揪團截止時間是否已超過
					let gpaEndDateToDate = new Date(gpaEndDate);
					let currentDate = new Date();
					if (currentDate >= gpaEndDateToDate) { // 如果揪團已經截止，關閉按鈕的使用
						$("a#rpProd").attr("disabled", "disabled");
						$("a#orderNow").attr("disabled", "disabled");
						$("a#track").attr("disabled", "disabled");
						$("span#gpaEndDate").text(gpaEndDateToformatted + " (已截止)");
						$("span#gpaEndDate").css("color", "red");
					}

					// if (gpaPreProd <= 0) { // 如果庫存數量小於等於0時，將預訂按鈕失效
					// 	$("a#orderNow").attr("disabled", "disabled");
					// }

					$("button#addChatroom").attr("onclick", `addChatroom(${memberNo})`); // 於加入聊天室增加onclick事件，並回傳當前賣家的memberNo
					$("button#addBlacklist").attr("onclick", `addBlacklist(${memberNo})`); // 於加入黑名單增加onclick事件，並回傳當前賣家的memberNo
					$("button#gpaReach").attr("onclick", `showGpaReach()`); // 於加入黑名單增加onclick事件，並回傳當前賣家的memberNo

					maxPicNumOfProd = gpaProdPics.length - 1; // 將商品的最大數量保存至全域變數(起始值為0，所以長度-1)
					prodPicCount = 0;

					gpaProdPics.forEach(gpaProdPic => {
						$("div#slider").append(`
							<div class="slide2" style="width: 100%; height: 100%;">
								<img id="prodPic${prodPicCount}" src="data:image/jpeg;base64,${gpaProdPic.gpaProdPicToBase64}" style="width: 100%; height: 100%;" >
							</div>
						`);
						prodPicCount++;

					});

					//代表圖片數量的點點 Start (圖片滑動顯示)
					for (let d = 1; d <= prodPicCount; d++) {

						$("#dots-con").append(`
							<span class="dot"></span>
						`);
					}
					var slides = document.querySelectorAll(".slide2"); //注意要將.slide 改成.slide2
					var dots = document.querySelectorAll(".dot");

					changeSlide(slides);
					//代表圖片數量的點點 End (圖片滑動顯示)

					if (gpaReach.length === 0) {
						$("div#gpaReachList").append(`
							<p>該賣場未設定達標優惠門檻</p>
						`);
					}

					gpaReach.forEach(perGpaReach => { // 遍歷揪團達標條件
						let { gpaLevelCount, gpaLevelPrice } = perGpaReach;

						if (Number($("span#gpaPreProd").text()) >= Number(gpaLevelCount)) { // 若該遍歷的達標條件有達標
							$("span#afterProdPrice").text("優惠價$" + gpaLevelPrice); // 將遍歷到的優惠價覆蓋先前的價格
							$("span#beforeProdPrice").text("原售價$" + gpaFirstPrice); // 將最初的價格顯示到beforeProdPrice
							$("span#beforeProdPrice").css("text-decoration", "line-through"); // 新增刪除線
							$("span#beforeProdPrice").css("display", ""); // 刪除隱藏(顯示出來)


							currentGpaProdPrice = gpaLevelPrice; // 將優惠價設置進全域變數

							// 將已完成的達標條件依序印至燈箱內
							$("div#gpaReachList").append(`
								<p style="color: red">達標預定數量:${gpaLevelCount} > 優惠價:$${gpaLevelPrice} 已達標✓</p>
							`);
						}
						else { // 若該遍歷的達標條件沒有達標
							// 將達標條件依序印至燈箱內
							$("div#gpaReachList").append(`
								<p>達標預定數量:${gpaLevelCount} > 優惠價:$${gpaLevelPrice}</p>
							`);
						}
					})
					$("#orderNowLightbox_totoalPrice").text(Number(currentGpaProdPrice) + 100); // 將商品價格+運費100元顯示於預定燈箱的總金額
					setRecommendedGpaProd(gpaCatsNo, currentParameterValue_gpaProdNo); // 設置推薦商品
				});
		});

		//將商品類別的編號轉成文字資訊
		function changeObjText(paProdObjNo) {
			switch (paProdObjNo) {
				case 1:
					return '女生衣著';
				case 2:
					return '美食';
				case 3:
					return '伴手禮';
				case 4:
					return '手機平板與周邊';
				case 5:
					return '文創用品';
				case 6:
					return '書籍及雜誌期刊';
				case 7:
					return '男女鞋';
				case 8:
					return '娛樂、收藏';
				case 9:
					return '男生包包與配件';
				case 10:
					return '服務、票券';
				case 11:
					return '男生衣著';
				case 12:
					return '汽機車零件百貨';
				case 13:
					return '嬰幼兒與母親';
				case 14:
					return '3C與筆電';
				case 15:
					return '居家生活';
				case 16:
					return '女姓配件/黃金';
				case 17:
					return '寵物';
				case 18:
					return '戶外/旅行';
				case 19:
					return '運動/健身';
				case 20:
					return '電玩遊戲';
				case 21:
					return '女性包包/精品';
				case 22:
					return '家電影音';
				case 23:
					return '其他類別';
				default:
					return '出現錯誤，請聯繫客服人員';
			}
		}

		// 加入黑名單事件
		function addBlacklist(sellerMemberNo) {
			fetch('/BuyGo/needLoginApi/front_end/blacklist', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					action: "addBlacklist",
					memberNoBlack: sellerMemberNo
				})
			})
				.then(response => {
					if (response.status === 401) {
						// 客戶未登入，執行頁面重定向到登入頁
						notLoggedInAction();
					} else if (response.ok) {
						// 請求成功
						return response.json();
					} else {
						alert("錯誤狀態:" + response.status);
						return;
					}
				})
				.then(body => {
					const { message, successful } = body

					if (successful) {
						// sweetalert
						Swal.fire({
							position: 'center',
							icon: 'success',
							title: '新增黑名單成功',
							showConfirmButton: false,
							timer: 1500
						})
					}
					else {
						// sweetalert
						Swal.fire({
							icon: 'error',
							title: `加入黑名單失敗`,
							text: `${message}`
						})
					}
				});
		}

		// 加入聊天室事件
		function addChatroom(sellerMemberNo) {
			fetch('/BuyGo/needLoginApi/front_end/addChatRoom', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					memberNo: sellerMemberNo
				})
			})
				.then(response => {
					if (response.status === 401) {
						// 客戶未登入，執行頁面重定向到登入頁
						notLoggedInAction();
					} else if (response.ok) {
						// 請求成功
						return response.json();
					} else {
						alert("錯誤狀態:" + response.status);
						return;
					}
				})
				.then(body => {
					const { successful } = body;
					if (successful) {
						const swalWithBootstrapButtons = Swal.mixin({
							customClass: {
								confirmButton: 'btn btn-success',
								cancelButton: 'btn btn-danger'
							},
							buttonsStyling: false
						})

						swalWithBootstrapButtons.fire({
							title: '新增聊天室成功',
							text: "是否現在進入聊天室?",
							icon: 'success',
							showCancelButton: true,
							confirmButtonText: '好的，現在進入',
							cancelButtonText: '先不用',
							reverseButtons: true
						}).then((result) => {
							if (result.isConfirmed) {
								// 同意
								window.location.href = '/BuyGo/front_end/pages/member/chatroom.html'; // 跳轉至聊天室頁面url
							}
						})
					}
				})
		}

		// 設置推薦商品
		function setRecommendedGpaProd(gpaCatsNo, gpaProdNo) {
			fetch(`/BuyGo/api/front_end/gpaProd`, {
				method: 'POST',
				headers: { 'Content-Type': 'application/json;charset:utf-8' },
				body: JSON.stringify({
					action: "randomLoadByGpaCatsNoAndFilterGpaProdNo",
					gpaCatsNo: gpaCatsNo,
					gpaProdNo: gpaProdNo
				})
			})
				.then(resp => resp.json())
				.then(recommendedGpaProdDTOList => {
					let count = 0;

					recommendedGpaProdDTOList.forEach(recommendedGpaProdDTO => {
						let { gpaProdNo, gpaProdName, gpaFirstPrice, gpaPreProd, gpaEndDate, gpaProdPicToBase64, gpaReach } = recommendedGpaProdDTO;

						// 將gpaEndDate更換時間格式為指定格式
						let gpaEndDateToMoment = moment(gpaEndDate, "MMM DD, YYYY, h:mm:ss A");
						let gpaEndDateToformatted = gpaEndDateToMoment.format("YYYY-MM-DD HH:mm");

						count++;
						if (count > 4) { // 只需show出4個推薦商品，當count>3時不須再渲染商品至前端頁面
							return;
						}

						let specialPrice = 0; // 用以保存優惠價
						gpaReach.forEach(perGpaReach => {
							let { gpaLevelCount, gpaLevelPrice } = perGpaReach;
							if (gpaPreProd >= gpaLevelCount) { // 若該商品銷量大於等於達標數量時，將優惠價更新為
								specialPrice = gpaLevelPrice;
							}
						})

						$("#ranRecommend").append(`
					<div class="product" data-product-id="${count}" data-category="${gpaProdName}" data-brand="brand1" data-price="" data-colors="red|blue|black|white" data-size="S|M|L">
						<div class="entry-media">
							<div class="hover" style="overflow: hidden">
								<img src="data:image/jpeg;base64,${gpaProdPicToBase64}" class="entry-url">
							</div>
						</div>
						<div class="entry-main" style="border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
							<h5 class="entry-title">
								<a href="/BuyGo/front_end/pages/member/gpa/gpaProduct.html?gpaProdNo=${gpaProdNo}">${gpaProdName}</a>
							</h5>
							<div class="entry-price">
								<strong class="price" style="color: #fa6f57; margin: 0px 3px; font-weight: bold; ${specialPrice != 0 ? "" : "display: none;"}">$ ${specialPrice}</strong>
								<strong class="price" style="color: #fa6f57; margin: 0px 3px; font-weight: bold; ${specialPrice != 0 ? "text-decoration: line-through; font-size: 12px" : ""}">$ ${gpaFirstPrice}</strong>
							</div>
							<div class="entry-preProd">
								<p style="font-size: 12px">已預定數量:${gpaPreProd}</p>
							</div>
							<div class="entry-endDate">
								<p style="font-size: 12px">截止日期:${gpaEndDateToformatted}</p>
							</div>
						</div>
					</div>
					`);
					})
				})
		}

		function changeProdPic(addNum) {
			if (addNum === 1) {
				if (currentSelectOfPic === maxPicNumOfProd) {
					$(`#prodPic${currentSelectOfPic}`).css("display", "none");
					currentSelectOfPic = 0;
					$(`#prodPic${currentSelectOfPic}`).css("display", "");
				}
				else {
					$(`#prodPic${currentSelectOfPic}`).css("display", "none");
					currentSelectOfPic = currentSelectOfPic + addNum;
					$(`#prodPic${currentSelectOfPic}`).css("display", "");
				}
			}
			else if (addNum === -1) {
				if (currentSelectOfPic === 0) {
					$(`#prodPic${currentSelectOfPic}`).css("display", "none");
					currentSelectOfPic = maxPicNumOfProd;
					$(`#prodPic${currentSelectOfPic}`).css("display", "");
				}
				else {
					$(`#prodPic${currentSelectOfPic}`).css("display", "none");
					currentSelectOfPic = currentSelectOfPic + addNum;
					$(`#prodPic${currentSelectOfPic}`).css("display", "");
				}
			}
		}

		// Image Slider js Start (圖片滑動顯示)

		var index = 0;
		var slides, dots;

		function prevSlide(n) {
			index += n;
			var slides = document.querySelectorAll(".slide2");
			changeSlide(slides);
		}

		function nextSlide(n) {
			index += n;
			var slides = document.querySelectorAll(".slide2");
			changeSlide(slides);
		}

		function changeSlide(slides) {

			var dots = document.querySelectorAll(".dot");

			if (index > slides.length - 1)
				index = 0;

			if (index < 0)
				index = slides.length - 1;

			for (let i = 0; i < slides.length; i++) {
				slides[i].style.display = "none";
				dots[i].classList.remove("active_dot");
			}

			slides[index].style.display = "block";
			dots[index].classList.add("active_dot");
		}

		function orderNowByCreditCard() {
			let isCheckOK = true; // 用以判定輸入框是否都有輸入字
			if ($("input#gpaBuyName").val() === "") {
				$("span#gpaBuyNameCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyNameCheck").css("visibility", "hidden");
			}

			if ($("input#gpaBuyTel").val() === "") {
				$("span#gpaBuyTelCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyTelCheck").css("visibility", "hidden");
			}

			if ($("input#gpaBuyAdd").val() === "") {
				$("span#gpaBuyAddCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyAddCheck").css("visibility", "hidden");
			}

			if (isCheckOK) { // 確認輸入框是否都有輸入字，若都有輸入則放行
				// 信用卡付款
				fetch("/BuyGo/api/front_end/gpaProd", // 判斷當前商品庫存是否為0
					{
						method: "POST",
						headers: { "Content-Type": "application/json; charset=utf-8", },
						body: JSON.stringify({
							action: "loadGpaPreProdByGpaProdNo",
							gpaProdNo: currentGpaProdNo
						})
					})
					.then(resp => resp.json())
					.then(newGpaProd => {
						let { gpaPreProd } = newGpaProd;
						console.log("gpaPreProd:" + gpaPreProd);
						if (gpaPreProd > 0) {
							ecpayCheckout(); // 呼叫綠界付款function(該function內含訂單建立)
						}
						else {
							$("span#gpaPreProdCheck").css("visibility", "visible"); // 顯示錯誤訊息
						}
					})
			}
		}

		function orderNowByWallet() { // 使用錢包付款
			let isCheckOK = true; // 用以判定輸入框是否都有輸入字
			if ($("input#gpaBuyName").val() === "") {
				$("span#gpaBuyNameCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyNameCheck").css("visibility", "hidden");
			}

			if ($("input#gpaBuyTel").val() === "") {
				$("span#gpaBuyTelCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyTelCheck").css("visibility", "hidden");
			}

			if ($("input#gpaBuyAdd").val() === "") {
				$("span#gpaBuyAddCheck").css("visibility", "visible");
				isCheckOK = false;
			}
			else {
				$("span#gpaBuyAddCheck").css("visibility", "hidden");
			}

			if (isCheckOK) { // 確認輸入框是否都有輸入字，若都有輸入則放行
				fetch("/BuyGo/api/front_end/gpaProd", // 判斷當前商品庫存是否為0
					{
						method: "POST",
						headers: { "Content-Type": "application/json; charset=utf-8", },
						body: JSON.stringify({
							action: "loadGpaPreProdByGpaProdNo",
							gpaProdNo: currentGpaProdNo
						})
					})
					.then(resp => resp.json())
					.then(newGpaProd => {
						let { gpaPreProd } = newGpaProd;
						console.log("gpaPreProd:" + gpaPreProd);
						if (gpaPreProd > 0) {
							deductionWalletAmount(); // 呼叫錢包扣款function(該function內含訂單建立)
						}
						else {
							$("span#gpaPreProdCheck").css("visibility", "visible"); // 顯示錯誤訊息
						}
					})
			}
		}

		function createGpaOrder() {
			let shippingDetail = currentBuyerMemberNo + "," + currentGpaProdNo + "," + "1" + "," + Number(currentGpaProdPrice) + "," + "100" + "," + $("input#gpaBuyName").val() + "," + $("input#gpaBuyTel").val() + "," + $("input#gpaBuyAdd").val();
			// shippingDetailArray[0]為下單購買商品的買家會員編號
			// shippingDetailArray[1]為欲購買的商品編號
			// shippingDetailArray[2]為欲購買的商品數量
			// shippingDetailArray[3]為欲購買的商品金額(單價)
			// shippingDetailArray[4]為運費
			// shippingDetailArray[5]為買家設定的收貨人
			// shippingDetailArray[6]為買家設定的收貨電話
			// shippingDetailArray[7]為買家設定的收貨地址
			fetch(`/BuyGo/api/front_end/ECPayUpdateGpaOrder?ShippingDetail=${shippingDetail}`,
				{
					method: "GET",
					headers: { "Content-Type": "application/json; charset=utf-8", },
				})
				.then(resp => resp.json())
				.then(gpaSo => {
					let { successful } = gpaSo;
					console.log("successful:" + successful);
				})
		}

		function deductionWalletAmount() {
			// 電子錢包付款
			fetch("/BuyGo/needLoginApi/front_end/deductionWalletAmount",
				{
					method: "POST",
					headers: { "Content-Type": "application/json; charset=utf-8", },
					body: JSON.stringify({
						memberNo: currentBuyerMemberNo,
						walletDetail: "購買" + currentGpaProdName,
						deductionAmount: (Number(currentGpaProdPrice) + 100)
					})
				})
				.then(response => {
					if (response.status === 401) {
						// 客戶未登入，執行頁面重定向到登入頁
						notLoggedInAction();
					} else if (response.ok) {
						// 請求成功
						return response.json();
					} else {
						alert("錯誤狀態:" + response.status);
						return;
					}
				})
				.then(deductionWalletAmountDTO => {
					let { successful, message } = deductionWalletAmountDTO;
					if (successful) {
						createGpaOrder(); // 建立訂單
						// decreaseGpaPreProdByGpaProdNo(); // 庫存量-1
						$("span#gpaPreProd").text(Number($("span#gpaPreProd").text()) + 1); // 動態將畫面上的已預定數量+1
						$("span#stockQty").text(Number($("span#stockQty").text()) - 1); // 動態將畫面上的庫存數量-1

						orderNowLightbox_el.classList.add("none"); // 關閉燈箱

						const swalWithBootstrapButtons = Swal.mixin({
							customClass: {
								confirmButton: 'btn btn-success',
								cancelButton: 'btn btn-danger'
							},
							buttonsStyling: false
						})

						swalWithBootstrapButtons.fire({
							title: '商品預定成功',
							text: `${message}，是否進入訂單追蹤頁面?`,
							icon: 'success',
							showCancelButton: true,
							confirmButtonText: '好的，現在進入',
							cancelButtonText: '先不用',
							reverseButtons: true
						}).then((result) => {
							if (result.isConfirmed) {
								// 同意
								window.location.href = '/BuyGo/front_end/pages/member/gpa/gpaOrder.html'; // 跳轉至聊天室頁面url
							}
						})
					}
					else {
						orderNowLightbox_el.classList.add("none"); // 關閉燈箱

						// sweetalert
						Swal.fire({
							icon: 'error',
							title: `商品預定失敗`,
							text: `${message}`
						})
					}
				});
		}

		function decreaseGpaPreProdByGpaProdNo() { // 將指定的商品No的庫存數量-1，保存至資料庫
			fetch("/BuyGo/api/front_end/gpaProd",
				{
					method: "POST",
					headers: { "Content-Type": "application/json; charset=utf-8", },
					body: JSON.stringify({
						action: "decreaseGpaPreProdByGpaProdNo",
						gpaProdNo: currentGpaProdNo
					})
				})
		}

		function ecpayCheckout() { // 綠界付款動作，將呼叫綠界付款畫面
			fetch("/BuyGo/needLoginApi/ecpay/checkout",
				{
					method: "POST",
					headers: { "Content-Type": "application/json; charset=utf-8", },
					body: JSON.stringify({
						TotalAmount: Number(currentGpaProdPrice) + 100,
						TradeDesc: "交易描述",
						ItemName: currentGpaProdName,
						ClientBackURL: location.protocol + "//" + location.hostname + ":" + location.port + "/BuyGo/front_end/pages/member/gpa/gpaOrder.html", // 成功付款後導到訂單追蹤頁面
						CustomField1: "gpaOrderCheckout",
						CustomField2: "orderId",
						CustomField3: currentBuyerMemberNo + "," + currentGpaProdNo + "," + "1" + "," + Number(currentGpaProdPrice) + "," + "100" + "," + $("input#gpaBuyName").val() + "," + $("input#gpaBuyTel").val() + "," + $("input#gpaBuyAdd").val()
						// CustomField3[0]為下單購買商品的買家會員編號
						// CustomField3[1]為欲購買的商品編號
						// CustomField3[2]為欲購買的商品數量
						// CustomField3[3]為欲購買的商品金額(單價)
						// CustomField3[4]為運費
						// CustomField3[5]為買家設定的收貨人
						// CustomField3[6]為買家設定的收貨電話
						// CustomField3[7]為買家設定的收貨地址
					})
				})
				.then(response => {
					if (response.status === 401) {
						// 客戶未登入，執行頁面重定向到登入頁
						notLoggedInAction();
					} else if (response.ok) {
						// 請求成功
						return response.json();
					} else {
						alert("錯誤狀態:" + response.status);
						return;
					}
				})
				.then(data => {
					console.log(data);
					window.open(data); //開啟綠界付款網址
				});
		}

		function showGpaReach() {
			$("#lightbox").removeClass("none"); // 顯示燈箱
		}
		function showOrderNow() {
			$("#orderNowLightbox").removeClass("none"); // 顯示燈箱
		}

		// 燈箱事件開始
		// 點擊 modal 中的半透明黑色區域，關閉達標燈箱
		let lightbox_el = document.getElementById("lightbox");
		lightbox_el.addEventListener("click", function () {
			this.classList.add("none");
		});
		// 點擊 modal 中的半透明黑色區域，關閉預定燈箱
		let orderNowLightbox_el = document.getElementById("orderNowLightbox");
		orderNowLightbox_el.addEventListener("click", function () {
			this.classList.add("none");
		});


		// 點擊達標燈箱內的關閉按鈕，關閉達標燈箱
		let lightbox_close_el = document.getElementById("lightbox_close");
		lightbox_close_el.addEventListener("click", function () {
			lightbox_el.classList.add("none");
		})
		// 點擊預定燈箱內的關閉按鈕，關閉預定燈箱
		let orderNowLightbox_close_el = document.getElementById("orderNowLightbox_close");
		orderNowLightbox_close_el.addEventListener("click", function () {
			orderNowLightbox_el.classList.add("none");
		})


		// 點擊達標燈箱中的白色區域，不會關掉 modal
		lightbox_el.querySelector("article").addEventListener("click", function (e) {
			e.stopPropagation();
		});
		// 點擊預定燈箱中的白色區域，不會關掉 modal
		orderNowLightbox_el.querySelector("article").addEventListener("click", function (e) {
			e.stopPropagation();
		});
		// 燈箱事件結束
		//=============檢舉功能================

		document.getElementById('Rp_btn').addEventListener('click', function () {
			showGpaReach();
			const reportReason = document.getElementById("reportReason");
			const reportContent = document.getElementById("reportContent");
			const selectSausage = document.getElementById("selectSausage");
			const sellerNo_el = document.getElementById("sellerNo");
			$('input#prodNo').val(currentGpaProdNo);
			// lightbox.style.display = 'block';
			document.getElementById("submit_report").addEventListener("click", function () {

				fetch("/BuyGo/api/front_end/member/gpa/order/GpaProdRpIncrease", {
					method: "POST",
					headers: { 'Content-Type': 'application/json;charset:utf-8' },
					body: JSON.stringify({
						gpaProdNo: currentGpaProdNo,
						memberNo: sellerNo_el.value,
						gpaProdRpContent: reportContent.value,
						gpaProdRpReason: reportReason.value,
						prodSell: selectSausage.value
					})
				}).then(resp => resp.json())
					.then(body => {
						console.log(body);
						Swal.fire(
							'感謝您的建議!',
							'已成功送出'
						)
						lightbox_el.classList.add("none");
					})


			})

		});
		//=============檢舉結束================
	</script>

</body>

</html>